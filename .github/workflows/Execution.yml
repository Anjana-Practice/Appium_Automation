name: CI/CD with Appium

on:
  schedule:
    - cron: '0 16 * * *'  # Scheduled to run every day at 4:00 PM UTC (adjust as needed)

  workflow_dispatch:
    inputs:
      app-url:
        description: "bs://aa5a4b95e024b4a7a60d7b0e6678a930c38cfa99"
        required: true
        type: string
      device-details:
        description: "Android:Samsung Galaxy S22 Ultra:12.0"
        required: true
        type: string
      
env:
  BROWSER_STACK_USERNAME: anjanaprakash_hHWeNt
  BROWSER_STACK_ACCESS_KEY: t5KuKWzMqgRpyWCLhm87

jobs:
  run-presto-tests:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Java
        uses: actions/setup-java@v2
        with:
          java-version: "11"

      - name: Run the presto tests
        run: |
          mvn -q test
        env:
          BROWSER_STACK_HUB_URL: "https://${{ env.BROWSER_STACK_USERNAME }}:${{ env.BROWSER_STACK_ACCESS_KEY }}@hub.browserstack.com/wd/hub"
          DEVICE_DETAILS: "Android:Samsung Galaxy S22 Ultra:12.0"
          APP_URL: "bs://aa5a4b95e024b4a7a60d7b0e6678a930c38cfa99"

      - name: Push test logs to artifacts
        uses: actions/upload-artifact@v3
        with:
          name: Test Execution logs
          path: logs/test-appium.log

      - name: Push extent report html file to artifacts
        uses: actions/upload-artifact@v3
        with:
          name: Test Execution Result in HTML
          path: ExtentReports/AutomationResult.html
